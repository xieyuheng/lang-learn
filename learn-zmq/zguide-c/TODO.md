copy code from zguide repo
